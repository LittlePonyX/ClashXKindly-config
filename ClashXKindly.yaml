# --------------------------------ClashX Kindly Config-----------------------------------------------
# @GitHub https://github.com/LittlePonyX/ClashXKindly-config
# @Version 1.0.0
# @rules https://github.com/Loyalsoldier/clash-rules
# @rules https://github.com/blackmatrix7/ios_rule_script
# --------------------------------ClashX Kindly Config-----------------------------------------------

# mixed-port HTTP(S) and SOCKS5 ä½¿ç”¨åŒä¸€ç«¯å£7890
mixed-port: 7890
redir-port: 7892

# è§„åˆ™æ¨¡å¼ ruleï¼ˆè§„åˆ™ï¼‰ / globalï¼ˆå…¨å±€ä»£ç†ï¼‰/ directï¼ˆå…¨å±€ç›´è¿ï¼‰
mode: rule
allow-lan: true

# 5 ä¸ªçº§åˆ« silent / info / warning / error / debug
log-level: info

# RESTful API for clash
external-controller: 0.0.0.0:9090

# DNS æœåŠ¡å™¨é…ç½® æŒ‰éœ€å¯ç”¨
dns:
  enable: false
  listen: 0.0.0.0:53
  # å¢å¼ºæ¨¡å¼ æŒ‰éœ€å¯ç”¨
  enhanced-mode: fake-ip
  fake-ip-range: 198.18.0.1/16
  fake-ip-filter:
    - "*.lan"
    - localhost.ptlogin2.qq.com
    - +.srv.nintendo.net
    - +.stun.playstation.net
    - +.msftconnecttest.com
    - +.msftncsi.com
    - +.xboxlive.com
    - "*.blzstatic.cn"
  nameserver:
    - 223.5.5.5
    - 119.29.29.29
  fallback:
    - 8.8.8.8
    - 1.1.1.1
    - tls://dns.google:853
    - https://cloudflare-dns.com/dns-query
    - https://dns.google/dns-query
  fallback-filter:
    geoip: true
    geoip-code: CN
    ipcidr:
      - 240.0.0.0/4

# proxy-providerså‚æ•°é”šç‚¹ æ–¹ä¾¿å¤šè®¢é˜…æºå¤ç”¨
pvd-info: &pvd-info
  # æ›´æ–°è®¢é˜…å‘¨æœŸ 3å¤©
  interval: 259200
  # èŠ‚ç‚¹çŠ¶æ€æ£€æŸ¥
  health-check:
    enable: true
    url: http://www.gstatic.com/generate_204
    interval: 86400

# clash é“¾æ¥æ— é¡»è½¬æ¢ èŠ‚ç‚¹è®¢é˜…è½¬æ¢ https://sub.xeton.dev/sub?target=clash&url=è®¢é˜…é“¾æ¥å¤šä¸ªç”¨|åˆ†å‰²&list=true&udp=false
# å¯é€‰å…¶ä»–è®¢é˜…è½¬æ¢å·¥å…· æ¨èé€‰æ‹©è¾“å‡ºä¸º NodeList ä¹Ÿå¯å¤„ç†èŠ‚ç‚¹è¿‡æ»¤ç­‰
proxy-providers:
  Subscribe:
    # ä»£ç†æä¾›å•†ç±»å‹ http|file
    type: http
    # å¼•ç”¨å‚æ•°é”šç‚¹
    <<: *pvd-info
    # æ’é™¤å…³é”®å­—ä½¿ç”¨excludeå‚æ•°(UrlCodeç¼–ç )ä¾‹å¦‚è¦æ’é™¤"æµ·å¤–|åˆ°æœŸ"åœ¨é“¾æ¥åè¿½åŠ  &exclude=%E6%B5%B7%E5%A4%96%7C%E5%88%B0%E6%9C%9F
    url: https://sub.xeton.dev/sub?target=clash&url=è®¢é˜…é“¾æ¥å¤šä¸ªç”¨|åˆ†å‰²&list=true&udp=false&exclude=%E6%B5%B7%E5%A4%96%7C%E5%88%B0%E6%9C%9F
    # è®¢é˜…å†…å®¹ä¿å­˜è·¯å¾„
    path: ./Providers/Proxies/Subscribe.yaml
    # filter: 'HK|TW|US' # è¿‡æ»¤èŠ‚ç‚¹ Golang regexä¸æ”¯æŒå¤æ‚è¡¨è¾¾å¼ å¤æ‚è§„åˆ™å»ºè®®ç”¨è®¢é˜…è½¬æ¢å·¥å…·è¿‡æ»¤
  # ========å¼•ç”¨å½“å‰å·²æœ‰clashé…ç½®æ–‡ä»¶ç¤ºä¾‹========
  # MyConfig:
  #   type: file
  #   path: MyConfig.yaml # å½“å‰å·²æœ‰é…ç½®æ–‡ä»¶path
  #   health-check:
  #     enable: true
  #     interval: 36000
  #     url: http://www.gstatic.com/generate_204
  #   filter: 'JP|VN|SG'

  # å®šä¹‰èŠ‚ç‚¹è¿‡æ»¤å‚æ•°é”šç‚¹
  filter-info: &filter-info
    type: file
    path: ./Providers/Proxies/Subscribe.yaml

  # ä»£ç†ç»„ä¸­ä¸æ”¯æŒ filter åœ¨è¿™å¤„ç†
  HK-Node:
    <<: *filter-info
    filter: 'æ¸¯|HK|(?i)Hong'
  TW-Node:
    <<: *filter-info
    filter: 'å°|æ¹¾|TW|(?i)Taiwan'
  JP-Node:
    <<: *filter-info
    filter: 'æ—¥|ä¸œäº¬|JP|(?i)Japan'
  SG-Node:
    <<: *filter-info
    filter: 'æ–°|å¡|ç…|SG|(?i)Singapore'
  US-Node:
    <<: *filter-info
    filter: 'ç¾|US|(?i)States|American'

# ä½¿ç”¨proxy-providersä¸­çš„èŠ‚ç‚¹ å®šä¹‰é”šç‚¹
all-proxy: &all-proxy
  type: select
  use:
    - Subscribe
    # - MyConfig # å¼•ç”¨å·²æœ‰é…ç½®æ–‡ä»¶

# å…¶ä»–ä»£ç† è‡ªå»ºç­‰å†™åœ¨è¿™é‡Œ
proxies:
  - name: "ss1"
    type: ss
    server: server
    port: 443
    cipher: chacha20-ietf-poly1305
    password: "password"
    # udp: true

  - name: "ss2"
    type: ss
    server: server
    port: 443
    cipher: chacha20-ietf-poly1305
    password: "password"
    plugin: obfs
    plugin-opts:
      mode: tls # or http
      # host: bing.com

# å…¶ä»–ä»£ç†é”šç‚¹
local-proxy: &local-proxy
  - ss1
  - ss2

# å®šä¹‰è‡ªåŠ¨æµ‹é€ŸèŠ‚ç‚¹
auto: &auto-select
  type: url-test
  lazy: true
  url: http://www.gstatic.com/generate_204
  # èŠ‚ç‚¹æ£€æµ‹ é—´éš”10åˆ†é’Ÿ
  interval: 600
  use:
    - Subscribe
    # - MyConfig # å¼•ç”¨å·²æœ‰é…ç½®æ–‡ä»¶

# å®šä¹‰åˆ†æµå‚æ•°é”šç‚¹
group-proxy: &group-proxy
  type: select
  proxies:
    - ğŸš€ æ‰‹åŠ¨åˆ‡æ¢
    - â™»ï¸ è‡ªåŠ¨é€‰æ‹©
    - ğŸ‡­ğŸ‡° é¦™æ¸¯èŠ‚ç‚¹
    - ğŸ‡¨ğŸ‡³ å°æ¹¾èŠ‚ç‚¹
    - ğŸ‡¯ğŸ‡µ æ—¥æœ¬èŠ‚ç‚¹
    - ğŸ‡¸ğŸ‡¬ ç‹®åŸèŠ‚ç‚¹
    - ğŸ‡ºğŸ‡² ç¾å›½èŠ‚ç‚¹
    - DIRECT

# å®šä¹‰ä»£ç†åˆ†ç»„ ä¸é”šç‚¹åˆå¹¶
proxy-groups:
  - name: ğŸš€ æ‰‹åŠ¨åˆ‡æ¢
    <<: *all-proxy
    proxies:
      - â™»ï¸ è‡ªåŠ¨é€‰æ‹©
  - name: â™»ï¸ è‡ªåŠ¨é€‰æ‹©
    <<: *auto-select
    proxies:
      # æ·»åŠ è‡ªå®šä¹‰èŠ‚ç‚¹
      # - ss1
      # - ss2
  - name: ğŸŒ å›½å¤–åª’ä½“
    type: select
    <<: *group-proxy
    proxies:
      - ğŸš€ æ‰‹åŠ¨åˆ‡æ¢
      - DIRECT
  - name: ğŸ è‹¹æœæœåŠ¡
    <<: *group-proxy
  - name: ğŸ“º å“”å“©å“”å“©
    type: select
    proxies:
      - DIRECT
      - ğŸ‡­ğŸ‡° é¦™æ¸¯èŠ‚ç‚¹
      - ğŸ‡¨ğŸ‡³ å°æ¹¾èŠ‚ç‚¹
  - name: ğŸ¤– OpenAi
    type: select
    proxies:
      - ğŸš€ æ‰‹åŠ¨åˆ‡æ¢
      - ğŸ‡ºğŸ‡² ç¾å›½èŠ‚ç‚¹
      - ğŸ‡¯ğŸ‡µ æ—¥æœ¬èŠ‚ç‚¹
  # - name: ğŸ† AdBlock # å¹¿å‘Šè¿‡æ»¤åˆ†ç»„ å·²ç”¨å…¶ä»–å¹¿å‘Šè¿‡æ»¤å·¥å…·ä¸å»ºè®®åœ¨Clashä¸­å†å¯ç”¨
  #   type: select
  #   proxies:
  #     - REJECT
  #     - DIRECT
  - name: ğŸ”§ è‡ªå®šèŠ‚ç‚¹
    type: select
    proxies:
      *local-proxy
  - name: ğŸŸ æ¼ç½‘ä¹‹é±¼
    <<: *group-proxy

 # èŠ‚ç‚¹æŒ‰åœ°åŒºåˆ†ç»„ Core ä¸æ”¯æŒæ­¤ç§è¿‡æ»¤ Metaå¯ä»¥ç›´æ¥ç”¨
  # - name: ğŸ‡­ğŸ‡° é¦™æ¸¯èŠ‚ç‚¹
  #   <<: *all-proxy
  #   filter: 'æ¸¯|HK|(?i)Hong'
  # - name: ğŸ‡¨ğŸ‡³ å°æ¹¾èŠ‚ç‚¹
  #   <<: *all-proxy
  #   filter: 'å°|æ¹¾|TW|(?i)Taiwan'

 # èŠ‚ç‚¹æŒ‰åœ°åŒºåˆ†ç»„ å½“å‰æ‰‹åŠ¨é€‰æ‹©èŠ‚ç‚¹ å¯å‚è€ƒauto-selecté”šç‚¹æ”¹ä¸ºè‡ªåŠ¨é€‰æ‹©
  - name: ğŸ‡­ğŸ‡° é¦™æ¸¯èŠ‚ç‚¹
    type: select
    use:
      - HK-Node
  - name: ğŸ‡¨ğŸ‡³ å°æ¹¾èŠ‚ç‚¹
    type: select
    use:
      - TW-Node
  - name: ğŸ‡¯ğŸ‡µ æ—¥æœ¬èŠ‚ç‚¹
    type: select
    use:
      - JP-Node
  - name: ğŸ‡¸ğŸ‡¬ ç‹®åŸèŠ‚ç‚¹
    type: select
    use:
      - SG-Node
  - name: ğŸ‡ºğŸ‡² ç¾å›½èŠ‚ç‚¹
    type: select
    use:
      - US-Node

# å®šä¹‰è§„åˆ™é›†å‚æ•°é”šç‚¹ interval 3 å¤©æ›´æ–°ä¸€æ¬¡è¶³å¤Ÿ
rule-info: &rule-info
  type: http
  interval: 259200
# classical ä¸æ¨èä½¿ç”¨ å¤æ‚åº¦è¾ƒé«˜ä¸å»ºè®®æ·»åŠ å¤ªå¤š
classical: &rule-classical
  behavior: classical
  <<: *rule-info
# domain or ipcidr æ¨èä½¿ç”¨ åŒ¹é…æ›´é«˜æ•ˆ
domain: &rule-domain
  behavior: domain
  <<: *rule-info
ipcidr: &rule-ipcidr
  behavior: ipcidr
  <<: *rule-info

# å¼•ç”¨è§„åˆ™é›†
rule-providers:
  Apple:
    <<: *rule-domain
    url: https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/apple.txt
    path: ./Providers/Ruleset/Apple.yaml
  iCloud:
    <<: *rule-domain
    url: https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/icloud.txt
    path: ./Providers/Ruleset/iCloud.yaml
  Direct:
    <<: *rule-domain
    url: https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/direct.txt
    path: ./Providers/Ruleset/Direct.yaml
  Private:
    <<: *rule-domain
    url: https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/private.txt
    path: ./Providers/Ruleset/Private.yaml
  Proxy:
    <<: *rule-domain
    url: https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/proxy.txt
    path: ./Providers/Ruleset/Proxy.yaml
  GFWList:
    <<: *rule-domain
    url: https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/gfw.txt
    path: ./Providers/Ruleset/GFWList.yaml
  Applications:
    <<: *rule-classical
    url: https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/applications.txt
    path: ./Providers/Ruleset/Applications.yaml
  BiliBili:
    <<: *rule-classical
    url: https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/BiliBili/BiliBili.yaml
    path: ./Providers/Ruleset/BiliBili.yaml
  GlobalMedia:
    <<: *rule-classical
    url: https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/GlobalMedia/GlobalMedia.yaml
    path: ./Providers/Ruleset/GlobalMedia.yaml
  Cncidr:
    <<: *rule-ipcidr
    url: https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/cncidr.txt
    path: ./Providers/Ruleset/Cncidr.yaml
  # anti-ADçš„å¹¿å‘Šè¿‡æ»¤ æŒ‰éœ€å¯ç”¨
  # Ad:
  #   <<: *rule-domain
  #   url: https://anti-ad.net/clash.yaml
  #   path: ./Providers/Ruleset/anti-ad-clash.yaml

# è‡ªå®šä¹‰è§„åˆ™
rules:
  - RULE-SET,Applications,DIRECT
  - RULE-SET,Private,DIRECT
  - RULE-SET,Cncidr,DIRECT
  - RULE-SET,Direct,DIRECT
  - RULE-SET,Apple,ğŸ è‹¹æœæœåŠ¡
  - RULE-SET,iCloud,ğŸ è‹¹æœæœåŠ¡
  - RULE-SET,BiliBili,ğŸ“º å“”å“©å“”å“©
  - RULE-SET,GlobalMedia,ğŸŒ å›½å¤–åª’ä½“
  - RULE-SET,Proxy,ğŸš€ æ‰‹åŠ¨åˆ‡æ¢
  # - RULE-SET,Ad,ğŸ† AdBlock # å¹¿å‘Šè¿‡æ»¤ æŒ‰éœ€å¯ç”¨
  - GEOIP,LAN,DIRECT # GEOIP LAN å’Œ CN ä½¿ç”¨ç›´è¿
  - GEOIP,CN,DIRECT # æ™®é€šç”¨æˆ·è¿™ä¸¤ä¸ªå°±å¤Ÿ
  # ========å…¶ä»–è‡ªå®šä¹‰è§„åˆ™ç¤ºä¾‹========
  - DOMAIN-SUFFIX,ai.com,ğŸ¤– OpenAi # åŸŸååç¼€åŒ¹é… ä½¿ç”¨ä»£ç†ç»„
  - DOMAIN-SUFFIX,openai.com,ğŸ¤– OpenAi
  - DOMAIN-SUFFIX,identrust.com,ğŸ¤– OpenAi
  - IP-CIDR,162.159.193.0/24,DIRECT # IP æ®µåŒ¹é… Cloudflare
  - DOMAIN-SUFFIX,umeng.co,REJECT # REJECT å¹¿å‘Šæ‹¦æˆª
  - DOMAIN-SUFFIX,umeng.com,REJECT
  - DOMAIN-SUFFIX,umtrack.com,REJECT
  - DOMAIN-SUFFIX,a.market.xiaomi.com,REJECT
  - DOMAIN-SUFFIX,ad.xiaomi.com,REJECT
  - DOMAIN-SUFFIX,ad1.xiaomi.com,REJECT

  # ä¸Šé¢è§„åˆ™éƒ½æœªå‘½ä¸­
  - MATCH,ğŸŸ æ¼ç½‘ä¹‹é±¼ # ä½¿ç”¨æ¼ç½‘ä¹‹é±¼åˆ†ç»„,å¯ä»¥ç†è§£ä¸ºé»‘åå•æ¨¡å¼
  # - MATCH, DIRECT # ç›´è¿ å³ç™½åå•æ¨¡å¼ é…åˆä¸‹æ–¹GFWListæ•ˆæœæ›´ä½³
  # - RULE-SET,GFWList,ğŸš€ æ‰‹åŠ¨åˆ‡æ¢
